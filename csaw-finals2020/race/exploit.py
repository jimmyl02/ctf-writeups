import requests
from time import sleep
from threading import Thread
import sys

sid = '4c178114842ece32'
session = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOiI5NWE3NDQ1My1kMDliLTRjNTctYTlkNy0wMTI1ZDIzOTVlNzMiLCJtb25leSI6NDg5MzQ0MH0.5SdpJ6w6nBWStcAnjur5jv7vnTEAOKXDVsAFoETOoXk'
money = 4893440

def bet(amount):
    url = 'https://snail.racecraft.cf/bet/0'
    cookies = {'sid': sid, 'session': session}
    data = {'bet': amount}
    r = requests.patch(url, cookies=cookies, data=data)
    if 'true' in r.text:
        print('[*] Bet made for ' + str(money))
    else:
        print('[!] Error in betting', r.text)

def checkAndUpdate():
    print('Started checking thread')
    global sid, session, money
    url = 'https://snail.racecraft.cf/check'
    while True:
        cookies = {'sid': sid, 'session': session}
        r = requests.get(url, cookies=cookies)
        session_cookie = r.cookies['session']
        req_data = r.json()
        if session_cookie != session:
            if req_data['money'] > money:
                session = session_cookie
                money = req_data['money']
                print('[*] ' +str(req_data['money']) + ' ' + str(money))
                print('[*] Session cookie: ' + session)
        #print('Text: ' + str(r.json()))
        #print('Cookies: ' + str(r.cookies['session']))
        sys.stdout.flush()
        sleep(10)

t = Thread(target=checkAndUpdate)
t.daemon = True
t.start()

while True:
    bet(money)
    sleep(20)
